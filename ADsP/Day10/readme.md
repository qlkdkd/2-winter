## 02. 기초통계
### 1. t-검정
### (1) 일 표본 t-검정(one sample t-test)
1. 일 표본 t-검정의 개념
  * 일 표본 t-검정: 가설검정의 일종, 하나의 모집단의 평균(n)값을 특정값과 비교하는 경우 사용하는 통계 분석

2. 일 표본 단축 t-검정
  * 모수에 대한 검정을 할 때 모수값이 '\~보다 크다' 혹은 '~보다 작다'와 같이 한 쪽으로 방향성을 갖는 경우 수행되는 검정방법
  * 예
      * 귀무가설: 00공장에서 생산되는 지우개의 평균 중량은 50g 이하다
->
```r
# 일 표본 단축 t-검정을 위한 지우개 10개의 표본 추출
weights=runif(10, min=49, max=52)
t.test(weights, mu=50, alternative='greater')#반대 방향은 'less' 사용
```
![image](https://github.com/qlkdkd/2-winter/assets/71871927/a402412e-53ed-4361-9c6b-5c497dc5bbbd)

  * 결과: 검정통계량: t=2.6963, 자유도: df=9(10-1)
  * p-value<0.05: 귀무가설 기각
  * 따라서 '00공장에서 생산되는 지우개의 평균 중량은 50g 이하다' 라는 귀무가설 기각,
  * 대립가설 '00공장에서 생산되는 지우개의 평균 중량은 50g보다 크다'라는 대립가설 채택

3. 일 표본 양측 t-검정
  * 단측 검정처럼 방향성을 갖지 않고 모수값이 '\~이다' 혹은 '~이 아니다'와 같이 방향성이 없는 경우 수행되는 검정방법
  * 예
      * 귀무가설: '대한민국 남성의 평균 몸무게는 70kg이다
```r
#일 표본 양측 t-검정을 위한 40kg~100kg 사이 남성 100명의 표본 추출
weights=runif(100, min=40, max=100)
t.test(weights, mu=70, alternative='two.sided')
```
![image](https://github.com/qlkdkd/2-winter/assets/71871927/63b8d5f8-1224-403c-a0eb-d488e4ec14db)
  * 결과: 검정통계량 t=1.2687, 자유도=99(100-1)
  * p-value\>0.5: 귀무가설 기각 불가
  * '대한민국 남성의 평균 몸무게는 70kg이다'라는 귀무가설 채택

### (2) 이(독립)표본 t-검정(독립표본 t-검정, independent sample t-test)
1. 이 표본 t-검정의 개념
  * 이 표본 t-검정: 가설검정의 일종, 서로 독립적인 두 개의 집단에 대하여 모수(모평균)의 값이 같은 값을 갖는지 통계적으로 검정하는 방법
  * 독립: 두 모집단에서 각각 추출된 두 표본이 서로 관계가 없다는 것을 의미
  * 두 모집단의 분산이 같음을 의미하는 등분산성 만족-> 표본 t-검정 수행 전 등분산 검정(F-검정) 먼저 수행
  * 독립: 두 모집단에서 각각 추출된 두 표본이 서로 관계가 없다는 것을 의미
  * 두 모집단의 분산이 같음을 의미하는 등분산성을 만족-> 이 표본 t-검정 수행 전 등분산 검정(F 검정) 먼저 수

2. 이 표본 단측 t-검정
   * 두 집단에 대하여 모수 비교를 할 떄 '\~이 \~보다 크다' 혹은 \~이 \~보다 작다'와 같이 두 집단 사이에 대소가 있는 경우 수행되는 검정 방법
   * 예: 'A회사의 급여가 B회사의 급여보다 같거나 많다'라는 귀무가설
```r
#이 표본 단측 t-검정을 위한 표본 추출
salaryA=runif(100, min=250, max=300)
salaryB=runif(100, min=200, max=400)
t.test(salaryA, salaryB, alternative='less')
```
![image](https://github.com/qlkdkd/2-winter/assets/71871927/a17d22e7-935c-45b3-ab95-7a932cedc6e9)
   * 결과: 검정통계량 t=2.26226, 자유도 df=172.16
   * p-value=0.9952\>0.05 -\> 귀무가설 기각 x
   * A>=B

3. 이 표본 양측 t-검정
   * 두 집단에 대하여 모수 비교를 할 때 '두 집단이 같다' 혹은 '두 집단이 다르다'와 같이 두 집단 사이에 대소가 없는 경우 수행되는 검정 방법
   * 예: 'K와 L이 달리기 속도는 같다'라는 귀무가설
```r
#이표본 양측 t-검정을 위한 표본 추출
speedK=runif(100, min=30, max=40)
speedL=runif(100, min=25, max=35)
t.test(speedK, speedL, alternative='two.sided')
```
![image](https://github.com/qlkdkd/2-winter/assets/71871927/7216e9d0-cbd0-4bdc-857d-c38b7b7a44b9)
  * 결과: 검정통계량 t=3.2704, 자유도 df=17.141
  * p-value=0.00447\<0.05: 귀무가설 기각
  * A!=B

### (3) 대응 표본 t-검정(paired t-test)
1. 대응표본 t-검정 개념
  * 동일한 대상에 대해 두 가지 관측자가 있는 경우 이를 비교하여 차이가 있는지 검정할 떄 사용
  * 주로 실험 전후의 효과를 비교하기 위해 사용
  * 예: 두 집단에 신약 투약 이후의 전후 수치 비교, 새로운 정책이 시행된 후의 부동산 가격의 전후 변화 등

2. 대응 표본 t-검정
  * 예: 새로운 운동법이 체중감량의 효과가 있는지 검증하기 위해 새로운 운동법을 실시한 집단과 실시하지 않은 집단의 체중을 비교한다고 했을 때 대응 표본 t-검정을 수행
  * '새로운 운동법으로 체중 감량의 효과는 없다(운동 전 무게-운동 후 무게 \<=0)' 라는 귀무가설을 수립, R에서 t-검정 수행
```r
#대응표본 t-검정을 위한 표본 추출
before=runif(100, min=60, max=80)
after=before+rnorm(10, mean=-3, sd=2)
t.test(before, after, alternative='greater', paired=TRUE)
```
![image](https://github.com/qlkdkd/2-winter/assets/71871927/95502079-f111-406e-90f5-7cc889c547cb)
  * 결과: 검정통계량 t=4.132, 자유도=9(10-1)
  * p-value=0.002552\<0.05: 귀무가설 기각
  * 새로운 운동법으로 인한 체중 감량 효과는 있다

---

### 2. 분산분석(ANOVA)
### 1. 분산분석
1. 개요
  * 분산분석: 세 개 이상의 모집단이 있을 경우 여러 집단 사이의 평균을 비교하는 검정 방법
  * 분산분석의 귀무가설: 항상 '$H_0$: 모든 집단 간 평균은 같다'
  * 분산분석을 수행하기 위해서 아래 세 가지 가정사항 필요
     1. 정규성: 각 집단의 표본들은 정규분포를 따라야 한다
     2. 등분산성: 각 집단은 동일한 분산을 가져야 한다
     3. 독립성: 각 집단은 서로 영향을 주지 않는다
  * 단점: 귀무가설을 기각할 경우 어느 집단 간 평균이 같은지, 혹은 어느 집단 간의 평균이 얼마나 다른 지 알 수 없음
  * 분산분석의 귀무가설을 기각했을 경우 어느 집단 간에 보이는지 알기 위한 사우 검정 방법
     * Scheffe
     * Tukey
     * Duncan
     * Fisher's LSD
     * Dunnett
     * Bonferroni 등
  * 분산분석의 독립변수: 범주형 데이터, 종속변수: 연속형
  * 분산 분석에는 F-value 사용($Fvalue=\frac{(집단 간 분산)}{(집단 내 분산)}$)
  * 평균을 비교하는 분산분석에 '분산'을 사용하는 이유: 집단 간 평균의 분산이 클수록 각 집단의 평균은 서로 멀리 떨어져 있기 때문

2. 일원분산분석
  * 셋 이상의 집단 간 평균을 비교하는 상황에서 하나의 집단에 속하는 독립변수와 종속변수 모두 1개일때 사용
  * 예: 연령대별(청소년, 성인, 노인) 유튜브 시청 시간의 차이가 있는지 알아보고 싶다고 가정
     * 독립변수: 연령별 집단-> 하나의 독립변수가 각각 종속변수에 영향을 끼
     * 종속변수: 유튜브 시청 시간
![image](https://github.com/qlkdkd/2-winter/assets/71871927/3360dd7a-df6e-4c9d-9f44-533f55348e44)
* SSE(residual sum of squares, Sum Squared Errors): 잔차들이 자신의 표본평균으로부터 벗어난 편차의 제곱
* SSR(explained sum of squares, Sum Squared Regression): 표본평균과 종속변수값 중 독립변수에 의해 설명된 부분과의 차이를 제곱하여 합한 값
* SST(Sum Squared Total): 종속변수의 관측값과 표본의 평균의 차이(편차)를 제곱하여 합한 값(SST=SSE+SSR)

3. 일원분산분석 R 실습
  * 신형 핸드폰 A, B, C의 속도 차이가 있는지 여부
  * 귀무가설($H_0$): A, B, C라는 세 대의 신형 핸드폰 간의 속도 차이는 없다
  * 대립가설($H_1$): 집단 간 평균의 차이는 존재한다
```r
#분산분석을 위한 데이터 생성
phoneSpeed=runif(45, min=75, max=100)
telecom=rep(c('A', 'B', 'C'), 15)
phoneData=data.frame(phoneSpeed, telecom)

#분산분석 수행
result=aov(data=phoneData, phoneSpeed~telecom)
summary(result)
```
![image](https://github.com/qlkdkd/2-winter/assets/71871927/aaa4ff77-8e74-4730-acf4-31bfdd3938f1)

  * p-value=0.447\>0.05 -\> 귀무가설 기각 x
  * 세 대의 신형 핸드폰간 속도 차이 없음

4. 이원분산분석(two-way Anova)
  * 일원분산분석 수행 시 독립변수의 수가 2개 이상일 때 사용
  * 예: 성별 연령별 유튜브 시청 시간 차이 알아보고 싶을 때
  * 독립변수간 교호작용이 있다고 판단될 때는 '반복이 있는 실험'을 하고, 교호작용이 없다고 판단될 때(두 독립변수가 독립인 경우) '반복이 없는 실험'을 함
  * 교호작용: 독립변수끼리 서로 영향을 미치는 경우
  * 예: '여성'이라는 독립변수의 경우 '노인'변수와 교호작용 미약할 수 있음, '청소년'변수와 만나면 서로 강한 교호작용 있을 수 있음
  * -> 이원분산분석을 수행할 때 독립변수 간 교호작용을 먼저 살펴보고 두 가지로 나누어 수행
  * 집단간의 평균 차이를 검증할 때 종속 변수 2개 이상-> 다변량분산분석(다원분산분석, Manova) 수행
![image](https://github.com/qlkdkd/2-winter/assets/71871927/076e992a-fbb7-4847-8e55-2c8833304423)

---

### 3. 교차분석
### (1) 교차분석
1. 교차분석의 개념
  * 범주형 자료(명목, 서열)간의 관계를 알아보고자 할 때 사용되는 분석 방법
  * 카이제곱($x^2$) 검정통계량 이용
  * 적합도 검정, 독립성 검정, 동질성 검정에 사용

2. 교차분석표
  * 두 범주형 변수를 교차하여 데이터의 빈도를 표 형태로 나타낸 것
  * 예: 지역별 전자제품 브랜드 선호도를 교차분석표로 작성했을 때, 우리나라와 미국에서 B사 브랜드 선호도가 높은 반면, 유럽에서는 A사 선호도가 높다
![image](https://github.com/qlkdkd/2-winter/assets/71871927/13ee0fed-19b4-4cfe-a0a6-d2fd6147d725)

### (2)적합도 검정
1. 적합도 검정 개념
  * 실험결과 얻어진 관측값이 예상값과 일치하는지 여부를 검정하는 방법
  * 실험 데이터: '관측 도수', 예측값: '기대 도수'
  * -> 모집단 분포에 대한 가정(예측값, 기대도수)이 옳게 됬는지 관측값(관측도수)과 비교하여 검정하는 것
  * 관측도수==기대도수 -> 실제 분포와 예측 분포 차이 X

2. 적합도 검정에서의 가설
  * 귀무가설: 실제 분포와 예측 분포 간에는 차이가 없다. = 두 분포가 일치한다
  * 대립가설: 실제 분포와 예측 분포 간에 차이가 있다. = 두 분포가 일치하지 않는다

3. 적합도 검정
  * 적합도 검정을 하는 유의 수준은 보통 $\alpha=0.05$로 정함
  * 적합도 검정의 기각값: 카이제곱 분포표에서 유의수준 $\alpha=0.05$일 때, 자유도 df=범주 수-1에 해당하는 $x_{a, df}$의 값이다.

### (3) 독립성 검정
* 독립성 검정: 모집단이 두 개의 변수에 의해 범주화됐을 때 그 두 변수들 사이의 관계가 독립적인지 아닌지 검정하는 것을 의미함
* 변수들 사이의 독립적-> 변수들 사이에 유의한 관계 없다고 판단, 만약 독립적이지 않으면 유의 관계 있다고 판단
* 카이제곱 검정에 의한 독립성 검정 결과: 두 범주형 변수 간에 관계가 있는지 없는지만을 나타낼 뿐, 두 변수 간 관계의 강도를 말해주진 않음
* 따라서 두 범주형 변수가 유의한 관계가 있다고 판단한다고 해서 두 범주형 변수 간에 상관관계가 강하다고 보진 않음.
  * -> 상관관계의 강도를 말하기 위해서는 상관분석을 실시해 수치를 따져봐야 함
 
### (4) 동질성 검정
* 동질성 검정: 관측값들이 정해진 범주 내에서 서로 비슷하게 나타나고 있는지를 검정하는 것
* 두 집단의 분포가 동일한 모집단에 추출된 것인지를 검정. 즉, 부모집단별로 요인에 대한 차이가 있는지 검정하는 것
* 예컨대 속성 A, B를 가진 부모집단 각각으로부터 정해진 표본의 크기만큼 자료를 추출하는 경우 표본의 관측값(표본의 속성 A, B)의 분포가 부모집단의 속성(모집단의 속성 A, B) 분포와 동일한가를 검정하는 것
* 동질성 검정통계량을 계산할 때 교차표 활용, 계산 및 검증법은 독립성 검정과 동일

---

### 4. 상관분석
### (1) 상관분석의 개념
1. 상관분석의 개념
  * 상관분석: 두 변수 간의 선형적 관계가 존재하는지 알아보는 분석 방법, 상관계수 활용
  * 상관계수: +1과 -1 사이의 값 가짐, +1에 가까울수록 강한 양의 상관관계, -1에 가까울수록 강한 음의 상관관계, 0에 가까울수록 상관관계 존재 X
  * 변수 간에 상관관계가 있다는 것이 반드시 그 변수들 사이에 인과관계가 있다는 말은 아님 -> 상관관계는 존재하지만 인과관계는 없을 수 있음

2. 산점도 행렬
  * R에서 산점도 행렬(Scatter Plot Matrix)을 그려 여러 변수를 조합한 산점도와 상관 계수를 한 화면에서 확인 가능
![image](https://github.com/qlkdkd/2-winter/assets/71871927/f11a50a9-4dd0-4170-aca3-d4536a5b6c65)

3. 상관분석 귀무가설
  * 상관분석의 귀무가설: $H_0:\gamma_{xy}=0$(두 변수는 아무 상관관계가 없다)
  * p-value가 유의수준보다 작아 귀무가설을 기각할 수 있다면 두 변수 간에 유의한 상관관계가 있다고 말할 수 있음

### (2) 상관분석의 종류
1. 피어슨 상관분석(선형적 상관관계)
  * 피어슨 상관관계는 모수적 방법의 하나로 두 변수가 모두 정규분포를 따른다는 가정이 필요
$$\gamma_{xy}=\frac{\sum_i^n(X_i-\bar{X})(Y_i-\bar{Y})}{\sqrt{\sum_i^n(X_i-\bar{X})^2}\sqrt{\sum_i^n(Y_i-\bar{Y})^2}}$$
```r
X=c(1, 2, 3, 4, 5)
Y=c(3, 6, 4, 9, 8)
cor(X, Y, method='pearson')
```
![image](https://github.com/qlkdkd/2-winter/assets/71871927/e1185ba8-0565-4e48-89e7-c0705d38428f)

2. 스피어만 상관분석(비선형적 상관관계)
  * 측정된 두 변수들이 서열척도일 때 사용하는 상관 계수
  * 비모수적 방법, 관측값의 순위에 대하여 상관계수를 구하는 방법
```r
X=c(1, 2, 3, 4, 5)
Y=c(3, 6, 4, 9, 8)
cor(X, Y, method='spearman')
```
![image](https://github.com/qlkdkd/2-winter/assets/71871927/fd87ad9d-c0e9-4354-9ff8-9ac22904ba63)

3. 상관분석 실습
  * 10명의 학생들에 대한 학습 시간과 시험 점수에 대한 데이터가 주어졌다. 학습 시간과 시험 점수 사이에 상관관계가 존재하는지 알아보자
```r
time=c(8, 6, 7, 3, 2, 4, 2, 7, 2, 3)
score=c(33, 22, 18, 6, 23, 10, 9, 30, 11, 13)
cor.test(time, score)
```
![image](https://github.com/qlkdkd/2-winter/assets/71871927/193f0da5-e0f4-49b6-8e86-559ad50c9235)
  * p-value=0.01527<0.05: 귀무가설 기각
  * 두 변수의 상관계수 추정치(cor)=0.7358112
  * 두 변수간(time, score) 상관관계가 있다고 통계적으로 말할 수 있음음

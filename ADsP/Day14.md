# 01. 데이터마이닝
## 1. 데이터마이닝 개요
### (1) 데이터 마이닝의 이해
#### 1. 데이터마이닝이란
* 데이터마이닝: 방대한 양의 데이터 속에서 숨겨진 규칙, 패턴 등을 찾아내어 예측하거나 의사결정에 활용하는 것을 목적으로 함
* 머신러닝 구현 바탕

#### 2. 통계분석과 데이터마이닝의 차이
* 통계학: 표본이 있어야 한다는 것과 그 표본을 통해 모집단의 어떤 특성을 추정하고 검정한다는 것이 중요
* 데이터마이닝: 가설과 검정 필요 없음, 데이터들을 분석하여 숨겨진 규칙이나 패턴을 찾아내는 것이 중요
* 데이터들 속에 숨겨진 규칙이나 패턴을 찾아낸다면 데이터마이닝을 통해 일종의 함수, 즉 모형을 만들 수 있고 그 모형을 토대로 예측이 가능
  * 예측이 가능함: 기업에 입장에서 보면 사업 성공의 가능성을 높이 끌어 올릴 수 있다는 의미
  * 예측이 아니라 설명이 가능함: 데이터마이닝을 통해 기업의 의사결정에 큰 도움이 될 것이며, 신제품 개발에 활용하여 신사업의 성공률을 높일 수 있음
* 광의의 개념: 데이터마이닝을 통해 인사이트(예측과 설명)를 얻는 과정으로 이해
  * 데이터마이닝의 궁극 목적: 인사이트를 얻어 이를 활용
* 데이터마이닝의 단계
  1. 목적 정의 단계: 분석의 목적과 필요한 데이터 정의
  2. 데이터 준비 단계: 필요한 데이터를 수집하고 데이터 정제를 통해 데이터의 품질을 보장
  3. 데이터 가공 단계: 분석 목적에 맞게 목표 변수를 정의하고 분석 기법 적용이 가능한 형태로 데이터를 가공
  4. 데이터마이닝 기법 적용 단계: 분석 기법을 적용해 목적하는 정보를 추출
  5. 검증 단계: 추출한 정보를 검증
 
### (2) 데이터마이닝의 종류
#### 1. 데이터마이닝 방법에 따른 분류
* 지도학습
  * 정답이 있는 데이터를 활용해 분석 모델을 학습시키는 것
  * 입력 데이터에 따른 출력 데이터 모두가 필요
  * 일종의 정답지가 필요
  * 독립변수에 따른 종속변수가 있다면 지도학습이라 할 수 있음
 
* 비지도학습
  * 정답을 알려주지 않고 학습하는 것
  * 컴퓨터가 학습할 때 입력 데이터만 가지고 그 속에 숨겨진 패턴을 찾아내는 학습 방법
  * 특징이 비슷한 데이터들끼리 군집화 실시
  * 독립변수에 따른 종속변수가 없으면 비지도학습
![image](https://github.com/qlkdkd/2-winter/assets/71871927/4a994f9a-b481-4a82-8a52-bf18df7cda4b)

#### 2. 데이터마이닝 분석 목적에 따른 분류
* 분류(Classification) 분석
  * 지도학습, 데이터가 어느 그룹에 속하는지 판별하고자 하는 분석기법
  * 로지스틱 회귀분석, 의사결정나무, 앙상블 분석, 인공신경망, K-NN(K-Nearest Neighborhood)

* 군집(Clustering) 분석
  * 비지도학습, 여러 이질적인 데이터들 사이의 유사성을 측정할여 유사성이 높은 객체끼리 하나의 그룹으로 묶기 위한 분석 방법
  * 병합적 방법, 분할적 방법, K-평균 군집(K-means Clustering)
 
* 연관(Association) 분석
  * 비지도학습, 장바구니 분석
  * 데이터의 연관성을 파악하는 분석 방법
  * 분석의 결과는 연관 규칙으로 나타냄
 
### (3) 데이터 마이닝의 프로세스
#### 1. 목적 정의
* 데이터마이닝의 결과로 무엇을 알고자 하는지 분명한 목적을 설정하는 단계
* 이해관계자 모두가 설정된 목적에 동의-> 전문가의 참여하에 데이터 마이닝에 필요한 기법 및 필요 데이터를 정의

#### 2. 데이터 준비
* 데이터마이닝에 필요한 데이터를 수집하는 단계
* 데이터 정제를 통해 데이터의 품질을 보장, 필요할 경우 보강 작업을 거쳐 충분한 양의 데이터를 확보하여 데이터 부족 문제가 발생하지 않도록 함

#### 3. 데이터 가공
* 데이터마이닝 목적에 따른 목적 변수 정의, 데이터마이닝에 적용 가능한 형식으로 데이터를 변환하는 단계

#### 4. 데이터 마이닝 기법 적용
* 앞서 준비된 데이터를 활용하여 데이터마이닝 기법을 적용하는 단계
* 어떤 알고리즘을 적용하느냐에 따라 결과의 성과가 달라지므로 분석 전문가 필요

#### 5. 검증
* 데이터마이닝의 결과로 얻은 모델에 대한 평가 및 실제 업무에서 적용 가능한지 성능을 검증하는 단계
* 평가가 우수하면 IT부서와 협의하여 업무에 적용하고 모델의 기대 효과를 알릴 수 있도록 함
![image](https://github.com/qlkdkd/2-winter/assets/71871927/5ee01543-677f-4265-8864-d1e0d8f22ed6)

---

## 2. 데이터 분할
### (1) 데이터 분할의 이해
#### 1. 데이터 분할
* 데이터마이닝 기법을 적용하기에 앞서 데이터를 훈련용 50%, 검정용 30%, 평가용 20%의 세 가지 데이터로 분할
  * 또는 훈련용 60%, 검정용 20%, 평가용 20%
* 훈련용 데이터는 모델을 구축하기 위해 활용, 검정용 데이터는 구축된 모델이 적합한지 검증, 평가용 데이터는 최종적으로 모델의 성능 평가
* 분석 모델의 주목적: 한번도 보지 못한 새로운 데이터를 분류 및 예측하는 것-> 학습에 전혀 영향을 주지 않은 테스트 데이터로 측정한 성과가 높아야 학습이 적절하게 잘 된 것이라 볼 수 있음
![image](https://github.com/qlkdkd/2-winter/assets/71871927/473a7165-9f42-4a56-9cf4-bbbe7926aa5a)

#### 2. 과적합(과대적합)과 과소적합
* 정규화 선형회귀: 제약 조건의 종류에 따라 릿지(Ridge), 라쏘(Rasso), 엘라스틱넷(Elastic Net) 회귀모형 사용
* 과적합: 데이터가 훈련용 데이터에 대하여 너무 많이 설명하려고 하여 모델이 복잡해지고 해석의 어려움 발생
  * 또 실제 데이터에 대해 예측력 떨어짐
* 과소적합: 데이터 부족문제, 모델이 너무 단순하여 데이터 충분히 설명 불가능
![image](https://github.com/qlkdkd/2-winter/assets/71871927/7908d919-10ca-4b87-95d7-81a51ee02bb2)

### (2) 데이터 분할을 통한 검증
#### 1. 홀드아웃
* 가장 보편적인 데이터 분할을 통한 검증 방법
* 전체 데이터 랜덤하게 추출-> 학습 데이터와 테스트 데이터로 분리
* 일반적으로 학습데이터 80%, 테스트데이터 20%, 또는 학습 데이터 60%, 검증데이터 20%, 테스트데이터 20%로 분할
* 검증 세트를 이용하여 다른 하이퍼파라미터 값에서 모델을 훈련하는 것을 계속 반복하고 성능 평가-> 만족할 만한 성능이 나온 하이퍼파라미터를 이용하여 테스트 세트에서 모델의 일반화 성능 추정
![image](https://github.com/qlkdkd/2-winter/assets/71871927/ce59316f-9b60-4941-823c-fc2f89d5c0f5)

#### 2. k-Fold 교차검증(cross-validation)
* 전체 데이터 셋을 k개의 집단으로 구분
* -> k-1개를 훈련용 데이터로, 나머지 1개를 펼ㅇ가용 데이터로 사용
* -> 구축된 k개의 모델을 종합하여 최종 모델을 구축하는 방법
* 장점: 모델의 정확도 향상, 과소적합 방지
* 단점: k번의 모델 구축으로 모델 훈련에 많은 시간 필요로 함
![image](https://github.com/qlkdkd/2-winter/assets/71871927/7c6d5630-368b-492c-943b-4cdbc88e24ec)

#### 3. 붓스트랩
* 표본을 다시 추출하는 방법의 일종
* 통계학에서 표본을 다시 추출하는 경우: 모델의 신뢰도를 높여 성능을 개선하고자 할 때
* -> 랜덤하게 반복 추출하여 머신러닝 모델의 성능 향상 꾀할 수 있음
* 항상 관측된 데이터로부터 복원 추출, 추정의 신뢰성을 평가하는 데 사용됨
* 데이터셋의 분포가 고르지 않은 경우에 사용, 과적합을 줄이는 데 도움이 됨
![image](https://github.com/qlkdkd/2-winter/assets/71871927/0be2f7d9-a6c9-4eaf-b5e5-b6c6aaba4d22)

#### 4. 계층별 k-겹 교차검증
* 주로 불균형 데이터를 분류하는 문제에서 사용하는 방법, 작동 방식은 k-폴드 교차검증과 동일
* 계층별 k-겹 교차검증은 각 폴드가 가지는 레이블의 분포가 유사하도록 폴드를 추출해 교차검증을 실시

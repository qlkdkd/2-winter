## 03. 회귀 분석
### 1. 회귀분석 개요
### (1) 회귀분석의 개념
1. 회귀분석
  * 회귀분석: 하나 이상의 독립변수($x_1, x_2, x_3,...$들이 종속변수(y)에 얼마나 영향을 미치는지 추정하는 통계기법
  * 독립변수와 종속변수의 인과관계: 독립변수가 원인-> 종속변수에 영향을 미침
    * 독립변수=원인변수, 종속변수=겨과변수
  * 독립변수 1개-> 단순선형회귀분석, 2개 이상-> 다중선형회귀분석
  * 회귀분석은 기본적으로 연속형 변수일 때 사용, 범주형 변수일 경우 이를 파생변수로 변환하여 사용(종속변수가 범주형일 경우 로지스틱 회귀 사용)
  * 변수들이 일정한 경향성을 띔-> 그 변수들이 일정한 인과관계 가짐을 추측할 수 있음
    * 산점도를 봤을 때 일정한 추세선 나타남: 경향성 가지거나 변수들 간에 인과관계 존재
  * 아래 그림을 볼때
    * 2번 그림은 선형적 추세
    * 3번 그림은 2차 곡선 추세
    * 나머지는 어떤 추세선을 나타낸다고 보기 어려움
![image](https://github.com/qlkdkd/2-winter/assets/71871927/8eeeba14-31e7-458f-b8f1-5aad51826c59)

2. 회귀분석의 종류

종류|식|모형
---|---|---
단순회귀|$y=w_0+w_1x+b$|1개의 독립변수와 반응변수가 직선(선형)관계
다중회귀|$y=w_0+w_1x_1+w_2x_2+...+w_nx_n+b$|n개의 독립변수와 반응변수가 선형 관계
다항회귀|$y=w_0+w_1x^1+w_2x^2+...w_nx^n+b$|n개의 독립변수와 반응변수가 2차함수 이상의 관계
비선형회귀|$y=ae^{w_1x}+b$, $y=aln(w_1x)+b$, $y=asin(w_1x)+b$|회귀식이 미지의 모수들과 선형관계가 아닌 경우(지수함수, 로그함수, 삼각함수 등)

### (2) 회귀분석의 가정
* 선형성
  * 독립변수와 종속변수가 선형적
  * 2차함수 회귀선을 갖는 다항회귀분석은 선형성 필요 x
  * 산점도 통해 분석하기 전 변수 사이의 관계를 짐작할 수 있어 회귀분석 하기 전 상관분석 거의 필수적으로 함께 따라옴
 
* 독립성
  * 단순회귀분석: 잔차와 독립변수 서로 독립
  * 다중회귀분석(독립변수 여러개): 독립변수들 간에 상관성 없이 독립
  * 만약 독립변수들 상관관계 존재하는 경우: 다중공선성. 이를 제거하고 회귀분석을 수행해야 함
 
* 등분산성
  * 분산이 같다는 의미, 잔차가 고르게 분포하고 있음
  * 잔차의 중심에서 분산이 같아야 한다는 의미. 등분산성을 만족하지 못하면 회귀선은 어떤 추세를 띠지 못하고 덩어리(뭉친) 모양을 하게 됨
 
* 정규성
  * 잔차항이 정규분포 형태를 띠는 것
  * Q-Q plot에서 잔차가 오른쪽으로 상승하는 형태를 띄면 정규성 만족
 
* 오차와 잔차
  * 오차: 모집단의 데이터를 활용하여 회귀 식을 구한 경우 예측 값과 실제 값의 차이, 모집단
  * 잔차: 모집단을 특정할 수 없는 경우 모집단의 일부인 표본집단으로 회귀식 추정-> 이때 표본집단에 의해 추정된 회귀식의 예측값과 실제 값의 차이
 
* 잔차도
  * 예측값과 실제값의 차이을 나타낸 산점도
  * 예측값-실제값=0-> 잔차도=0
  * 잔차도를 활용하여 회귀식의 선형성, 등분산성의 가정성의 위배 여부 및 그에 대한 해결책을 찾을 수 있음
![image](https://github.com/qlkdkd/2-winter/assets/71871927/120cf4dc-819d-4487-943f-a4eba27a75b7)

---

### 2. 단순선형회귀분석
### (1) 회귀계수의 추정
1. 단순선형회귀분석
  * 독립변수와 종속변수가 1개씩일 때 둘 사이의 인과관계를 분석하는 것, 두 변수의 관계가 선형
  * 최소제곱법을 활용하여 실제 데이터와 오차가 가장 작아지는 직선의 방정식 찾음
$$y=w_0+w_1x+b$$
![image](https://github.com/qlkdkd/2-winter/assets/71871927/cbd5b7a9-8042-4be5-959c-001341675260)

2. 최소제곱법으로 회귀계수 추정
  * 회귀분석의 기본 알고리즘: 최소제곱법을 통해 매개변수 추정-> 추정된 매개변수를 통해 추세선을 그려 값을 예측하는 것
  * 최소제곱법: 실제 관측치와 추세선에 의해 예측된 점 사이의 거리(오차를 제곱해 더한 값)을 최소화하는 것
  * 좌표평면상에서 다양한 추세선이 그려질 수는 있지만, 잔차의 제곱 합이 최소가 되는 추세선이 가장 합리적인 추세선-> 이를 통해 회귀분석
  * 아래 그림에서 오차(파란색)제곱합이 왼쪽보다 오른쪽 직선이 더 작기 때문에 오른쪽 직선이 더 이상적인 회귀추세선
![image](https://github.com/qlkdkd/2-winter/assets/71871927/1338e6f3-74b1-4c93-9a86-ae0c31aea486)

### (2) 회귀분선모형의 적합성
1. 회귀분석의 분산분석표
  * 회귀분석의 결과에 대한 모형 적합성을 검정하기 위해서는 분산분석표 사용
  * 독립변수 1개-> 단순회귀분석, 독립변수 2개 이상-> 다중회귀분석
![image](https://github.com/qlkdkd/2-winter/assets/71871927/dfbff344-0bcf-4e70-a936-de26ed156222)
![image](https://github.com/qlkdkd/2-winter/assets/71871927/56939a5a-13c8-4937-b4ff-391799d06edd)

2. 회귀모형의 통계적 유의성 검증
  * 회귀모형의 통계적 유의성은 F검증을 통해 확인
  * F검정은 분산의 차이를 확인할 때 사용, 분산의 차이가 크다=회귀모형에서 회귀계수가 크다
  * F값이 크다: F값이 0에서 얼마나 가까운지 확률적으로 측정한 P값은 상대적으로 작아진다.
     * P값: 회귀모형에서 0.05보다 작을 경우 유의미한 인과관계가 있다고 판단하는 중요한 기준
   
3. 회귀계수의 유의성 검증
  * 회귀계수의 유의성은 t-검정을 통해 확인
     * t-통계량: 회귀계수를 표준 오차로 나눈 값-> t-통계량이 크다는 것은 분모가 작다는 의미, 분모에 해당하는 표준오차가 작다고 볼 수 있음(회귀계수(분자)>표준오차(분모))
  * t-통계량 커지면 회귀계수 커짐-> 유의미한 인과관계 검증
  * 위 회귀모형의 통계적 유의성 검증에서 살펴 t-통계량 커지면 P값 작아짐

4. 모형의 설명력
  * 회귀모형의 설명력이 좋다.: 데이터들의 분포가 회귀선에 밀접하게 분포하고 있다.
  * 회귀분석 결과를 분산분석하고, 도출된 결정계수 $R^2$로 모형의 설명력 판단
  * 결정계수 $R^2$이 1에 가깝다: 데이터들이 회귀선에 매우 밀접하게 분포한다-> 회귀모형의 예측력이 높다-> 회귀모형이 주어진 자료를 잘 설명한다

$$R^2=\frac{Q-Q_e}{Q}$$
  * $Q$: 전체 데이터들의 편차들을 제곱하여 합한 값
  * $Q_e$: 전체 데이터들의 잔차들의 제곱하여 합한 값

$$R_2=\frac{SSR}{SST}=\frac{1-SSE}{SST}=\frac{1-SSE}{SSE+SSR}=\frac{회귀모형에 의해 설명되는 변동}{총변동}$$

### (3) 단순선형회귀분석의 예
1. 자동차 배기량과 연비 회귀분석
```r
X=c(1, 1.4, 1.6, 2.0, 2.2, 2.4, 3, 3.3, 3.6)#배기량(L)
Y=c(15, 13, 13, 12, 11, 10.5, 10, 9, 8)#연비(km/L)
result=lm(Y~X)#lm: 선형모델(Linear Model)의 약어
summary(result)
```
![image](https://github.com/qlkdkd/2-winter/assets/71871927/620f2968-d7d4-4edd-b3ad-4e052d0de0ec)
  * p-value=1.97e-06>0.05: 귀무가설 기각
  * 모든 회귀계수는 0이다
  * 모형이 유의하면 각 회귀계수에 대한 p-value를 확인해야 한다.
  * X의 회귀계수: -2.4371으로 추정 가능
  * 상수항의 추정치: 16.8291
  * -> 추정되는 회귀식: $Y(연비)=\{-2.4371*(배기량 X)\}+16.8291$

2. 분산분석표와 수정계수
```r
X=c(1, 1.4, 1.6, 2.0, 2.2, 2.4, 3, 3.3, 3.6)#배기량(L)
Y=c(15, 13, 13, 12, 11, 10.5, 10, 9, 8)#연비(km/L)
result=lm(Y~X)#lm: 선형모델(Linear Model)의 약어
anova(result)
```
![image](https://github.com/qlkdkd/2-winter/assets/71871927/7508df51-1381-4811-b2da-7d42f9c9710a)
$$R^2=\frac{SSR}{SST}=\frac{SSR}{SSR+SSE}=\frac{37.25}{27.27+1.281}=0.9668$$

---

### 3. 다중선형회귀분석
### (1) 다중선형회귀분석
* 독립변수가 2개 이상이고 종속변수가 하나일때 사용 가능한 회귀분석
* 독립변수와 종속변수의 관계가 선형으로 표시
* 단순회귀분석이 확장된 형태: 기본적인 회귀계수 및 통계적 유의성 검증 등은 단순회귀분석과 같음
* 회귀계수도 여러개
$$y=w_0+w_1x_1+w_2x_2+...+w_nx_n+b$$

### (2) 다중공선성
1. 다중공선성의 개념
  * 다중공선성: 회귀분석에서 독립변수 간에 강한 상관관계가 나타나는 문제
  * 다중공선성 존재: 독립성(독립변수 간에는 상관관계 없이 독립)에 위배
  * A, B라는 변수가 있을 때 이 둘 사이에 다중공선성이 존재하면 A라는 변수가 Y값에 어느 정도의 영향으 미치는지, 또 B라는 변수가 Y값에 어느 정도의 영향을 미치는지 정확하게 판단할 수 없음
  * 다중공선성을 해결하지 않고 분서을 하면 분석 결과의 회귀계수를 신뢰할 수 없고 잘못된 결과가 나올 수 있음

2
